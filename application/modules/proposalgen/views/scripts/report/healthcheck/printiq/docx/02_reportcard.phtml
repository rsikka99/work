<?php
/** Health Check - Report Card */

/* @var $phpword PHPWord */
$phpword = $this->phpword;

/* @var $section PHPWord_Section */
$section = $this->section;

/* @var $proposal Proposalgen_Model_Proposal_OfficeDepot */
$proposal = $this->healthcheck->proposal;
$section->addTitle($this->translate('Your PrintIQ� Health Check'), 1);
$section->addText($this->translate("Does your fleet of printing hardware deliver your users and business the greatest return on investment? How many trees and how much water are you using per year? This free PrintIQ Health Check will break down your current fleet and show you how you can lower your supplies costs, which devices are printing too much and which devices are printing too little, and the environmental impact of your fleet."));
$section->addText($this->translate("Data used in this Health Check is compiled using remote monitoring software, from the past 30 days."));

$section->addTitle($this->translate('Score Card'), 2);
$section->addText($this->translate('Your office printing environment was graded across five categories on a scale of 1 to 10. A score of 1 indicates a low-efficiency or high-cost scenario. A score of 10 indicates a high-efficiency or low-cost scenario. Your results are below:'));

$reportCardTable = $section->addTable($this->styles->tables->grades->tablestyle);
$rowHeight       = 800;
// Row 1
$reportCardTable->addRow($rowHeight);
$cell = $reportCardTable->addCell(8028, $this->styles->tables->grades->cell1);
$cell->addText($this->translate('Supplies and Service Logistics'), 'gradeTitleFont', 'nospacing');
$cell->addText($this->translate('Printing device management, number of various printer device models, and compatibility with Office Depot™ ATR (Auto Toner Replenishment).'), null, 'nospacing');
$cell = $reportCardTable->addCell(1000, $this->styles->tables->grades->cell2);
$cell->addText(number_format($proposal->getRanking()->SuppliesAndServiceLogistics->Rank, 1), 'gradeFont', 'gradeParagraph');

// Row 2
$reportCardTable->addRow($rowHeight);
$cell = $reportCardTable->addCell(8028, $this->styles->tables->grades->cell1);
$cell->addText($this->translate('Printing Hardware Usage'), 'gradeTitleFont', 'nospacing');
$cell->addText($this->translate('Total number of printing devices, average print volumes, underused and overused equipment, and color print usage.'), null, 'nospacing');
$cell = $reportCardTable->addCell(1000, $this->styles->tables->grades->cell2);
$cell->addText(number_format($proposal->getRanking()->PrintingHardwareUsage->Rank, 1), 'gradeFont', 'gradeParagraph');

// Row 3
$reportCardTable->addRow($rowHeight);
$cell = $reportCardTable->addCell(8028, $this->styles->tables->grades->cell1);
$cell->addText($this->translate('Technology Reliability and User Productivity'), 'gradeTitleFont', 'nospacing');
$cell->addText($this->translate('Age of printing devices, IT time spent managing printers, and availability of technology features that improve workflow and productivity.'), null, 'nospacing');
$cell = $reportCardTable->addCell(1000, $this->styles->tables->grades->cell2);
$cell->addText(number_format($proposal->getRanking()->TechnologyReliabilityAndUserProductivity->Rank, 1), 'gradeFont', 'gradeParagraph');

// Row 4
$reportCardTable->addRow($rowHeight);
$cell = $reportCardTable->addCell(8028, $this->styles->tables->grades->cell1);
$cell->addText($this->translate('Environmental Impact'), 'gradeTitleFont', 'nospacing');
$cell->addText($this->translate('Energy consumption from printing hardware and availability of green print technology features.'), null, 'nospacing');
$cell = $reportCardTable->addCell(1000, $this->styles->tables->grades->cell2);
$cell->addText(number_format($proposal->getRanking()->EnvironmentalFriendliness->Rank, 1), 'gradeFont', 'gradeParagraph');

// Textbreak fix to ensure the tables don't merge into each other
$section->addTextBreak();