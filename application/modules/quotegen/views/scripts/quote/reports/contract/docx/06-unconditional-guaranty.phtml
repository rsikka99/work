<?php
/* @var $section \PhpOffice\PhpWord\Element\Section */
$section = $this->section;

/* @var $contractTemplateSection Quotegen_Model_ContractTemplateSection */
$contractTemplateSection = $this->contractTemplateSection;

$tableSpan = $this->tableStyle->gridSpan;
$noSpacing = $this->paragraphStyle->noSpacing;
$labelFont = $this->fontStyle->label;

$unconditionalGuarantyTable = $section->addTable($this->tableStyle->standard);
$unconditionalGuarantyTable->addRow(300);
$unconditionalGuarantyTable->addCell(null, $this->cellStyle->fullWidthGridSpan4)->addText($contractTemplateSection->getContractSectionName(), $this->fontStyle->invertBackground, $noSpacing);

$guarantyHtml = new DOMDocument(5);
$guarantyHtml->loadHTML($contractTemplateSection->getContractSectionText());

/* @var $childNode DOMElement */
foreach ($guarantyHtml->getElementsByTagName('p') as $paragraphNode)
{
    $unconditionalGuarantyTable->addRow();
    $cell = $unconditionalGuarantyTable->addCell($tableSpan ['span8'], $this->cellStyle->gridSpan4);

    $textRun = $cell->addTextRun($this->paragraphStyle->justified);

    $childNodes = $paragraphNode->childNodes;
    for ($i = 0; $i < $childNodes->length; $i++)
    {
        /** @var $node DOMElement */
        $node = $childNodes->item($i);

        if ($node->tagName == 'b')
        {
            $textRun->addText($node->textContent, $this->fontStyle->boldFinePrint);
        }
        else
        {
            $textRun->addText($node->textContent, $this->fontStyle->finePrint);
        }
    }
}


// First Signature
$unconditionalGuarantyTable->addRow(350);
$unconditionalGuarantyTable->addCell($tableSpan ['span2'], $this->cellStyle->bottomBorderBAlign)->addText(' ', null, $noSpacing);
$unconditionalGuarantyTable->addCell($tableSpan ['span3'], $this->cellStyle->borderBAlign)->addText('X', null, $noSpacing);
$unconditionalGuarantyTable->addCell($tableSpan ['span3'], $this->cellStyle->bottomBorderBAlign)->addText('', null, $noSpacing);
$unconditionalGuarantyTable->addCell($tableSpan ['span1'], $this->cellStyle->bottomBorderBAlign)->addText('', null, $noSpacing);
$unconditionalGuarantyTable->addRow();
$unconditionalGuarantyTable->addCell($tableSpan ['span1'], $this->cellStyle->borderTop)->addText(' ', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$unconditionalGuarantyTable->addCell($tableSpan ['span3'], $this->cellStyle->borderTop)->addText('SIGNATURE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$unconditionalGuarantyTable->addCell($tableSpan ['span3'], $this->cellStyle->borderTop)->addText('PRINT NAME & TITLE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$unconditionalGuarantyTable->addCell($tableSpan ['span1'], $this->cellStyle->borderTop)->addText('DATE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);

// Second Signature
$unconditionalGuarantyTable->addRow(350);
$unconditionalGuarantyTable->addCell($tableSpan ['span2'], $this->cellStyle->bottomBorderBAlign)->addText(' ', null, $noSpacing);
$unconditionalGuarantyTable->addCell($tableSpan ['span3'], $this->cellStyle->borderBAlign)->addText('X', null, $noSpacing);
$unconditionalGuarantyTable->addCell($tableSpan ['span3'], $this->cellStyle->bottomBorderBAlign)->addText('', null, $noSpacing);
$unconditionalGuarantyTable->addCell($tableSpan ['span1'], $this->cellStyle->bottomBorderBAlign)->addText('', null, $noSpacing);
$unconditionalGuarantyTable->addRow();
$unconditionalGuarantyTable->addCell($tableSpan ['span1'], $this->cellStyle->borderTop)->addText(' ', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$unconditionalGuarantyTable->addCell($tableSpan ['span3'], $this->cellStyle->borderTop)->addText('SIGNATURE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$unconditionalGuarantyTable->addCell($tableSpan ['span3'], $this->cellStyle->borderTop)->addText('PRINT NAME & TITLE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$unconditionalGuarantyTable->addCell($tableSpan ['span1'], $this->cellStyle->borderTop)->addText('DATE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);

