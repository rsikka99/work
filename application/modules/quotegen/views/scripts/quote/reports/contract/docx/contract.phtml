<?php

/* @var $quote Quotegen_Model_Quote */
$quote = $this->quote;

/**
 * Equipment Schedule
 */
/* @var $section PHPWord_Section */
$section = $this->section;

// Title of the document 
$section->addText($this->translate($this->header->pageHeader), array (
        'size' => '18', 
        'color' => '0000FF' 
));

$deviceTableSpan = array (
        'span1' => 2764, 
        'span2' => 5528, 
        'span3' => 8292, 
        'span4' => 11056 
);

$agreementTableSpan = array (
        "span1" => 1382, 
        "span2" => 2764, 
        "span3" => 4146, 
        "span4" => 5528, 
        "span6" => 8292, 
        "span8" => 11056 
);

$agreementTableSpan = array (
        "span1" => 1382,
        "span2" => 2764,
        "span3" => 4146,
        "span4" => 5528,
        "span6" => 8292,
        "span8" => 11056
);

$noSpacing = $this->paragraphStyle->noSpacing;
$labelFont = $this->fontStyle->label;

/**
 * Begin creation of customer table
 */
$customerTable = $section->addTable($this->tableStyle->standard);


$customerTable->addRow();
$customerTable->addCell($agreementTableSpan ['span4'], null, 4)->addText($this->translate($this->header->subHeader), $this->fontStyle->subHeader, $noSpacing);
$customerTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->bottomAlign, 4)->addText($this->translate("Agreement No.:    {$this->agreement->number}"), null, $this->paragraphStyle->noSpacingRight);

$customerTable->addRow();
$customerTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->invertBackground, 8)->addText("CUSTOMER (\"you\" or \"your\")", $this->fontStyle->invertBackground, $noSpacing);

$customerTable->addRow();
$textRun = $customerTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->bottomBorder, 8)->createTextRun($noSpacing);
$textRun->addText(" FULL LEGAL NAME: ", $labelFont);
$textRun->addText(" {$this->company->name}", $this->fontStyle->bold);

$customerTable->addRow();
$textRun = $customerTable->addCell($agreementTableSpan ['span8'], null, 8)->createTextRun($noSpacing);
$textRun->addText(" ADDRESS: ", $labelFont);
$textRun->addText(" {$this->company->address}", $this->fontStyle->bold);
/**
 * End creation of customer table
 */

/**
 * Begin creation of pricing table
 */

$section->addTextBreak();
$termDetailsTable = $section->addTable($this->tableStyle->standard);
$termDetailsTable->addRow();
$termDetailsTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->invertBackground, 8)->addText("EQUIPEMENT AND PAYMENT TERMS", $this->fontStyle->invertBackground, $noSpacing);
$termDetailsTable->addRow();
$termDetailsTable->addCell($agreementTableSpan ['span1'], null, 2)->addText('TERM IN MONTHS', $labelFont, $noSpacing);
$termDetailsTable->addCell($agreementTableSpan ['span1'], null, 2)->addText('SECURITY DEPOSIT', $labelFont, $noSpacing);
$termDetailsTable->addCell($agreementTableSpan ['span4'], null, 4)->addText('METER FREQUENCY: MONTHLY OR SPECIFY OTHER: ___________', $labelFont, $noSpacing);


// $section->addTextBreak();
$leaseDetailsTable = $section->addTable($this->tableStyle->standard);
$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->invertBackground, 4)->addText("MPS PROGRAM", $this->fontStyle->invertBackground, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->invertBackground, 4)->addText("MPS PROGRAM PLUS", $this->fontStyle->invertBackground, $noSpacing);
// Row #1
$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->leftBorder, 2)->addText('', null, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomBorderBAlign)->addText(' B&W', $labelFont, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomRightBorderBAlign)->addText(' COLOR', $labelFont, $noSpacing);
$firstRowTextRun = $leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->leftRightBorder, 4)->createTextRun($noSpacing);
$firstRowTextRun->addText('MONTHLY FIXED CHARGE: ', $labelFont);
$firstRowTextRun->addText("  $ {$this->leaseDetails->monthlyCharge}         ", $this->fontStyle->underline);
$firstRowTextRun->addText("**");

// Row #2
$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->leftBorderBAlign, 2)->addText("PER PAGE CHARGE**: ", $labelFont, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomBorderBAlign)->addText("\${$this->leaseDetails->blackPerPageCharge}", null, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomRightBorderBAlign)->addText("\${$this->leaseDetails->colorPerPageCharge}", null, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomAlign, 2)->addText("", null, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomBorderBAlign)->addText("B&W ONLY DEVICE(S)", $labelFont, $this->paragraphStyle->noSpacingCentered);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomRightBorderBAlign)->addText("B&W AND COLOR DEVICE(S)", $labelFont, $this->paragraphStyle->noSpacingCentered);

// Row #3
$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->leftBorder, 4)->addText("", null, $noSpacing);
// $leaseDetailsTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->leftBorder, 2)->addText('MONTLY ALLOWANCE PER DEVICE:  ', $labelFont, $this->paragraphStyle->noSpacingRight);
$leaseDetailsTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->leftBorder, 2)->addText('MONTLY ALLOWANCE PER DEVICE:  ', $labelFont, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomBorder)->addText("{$this->leaseDetails->monochromeAllowance}", null, $this->paragraphStyle->noSpacingCentered);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomRightBorder)->addText("{$this->leaseDetails->colorAllowance}", null, $this->paragraphStyle->noSpacingCentered);

// Row #4
$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->leftBorder, 4)->addText("", null, $noSpacing);
// $leaseDetailsTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->leftBorder, 2)->addText("EXCESS PER PAGE CHARGE**:  ", $labelFont, $this->paragraphStyle->noSpacingRight);
$leaseDetailsTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->leftBorder, 2)->addText("EXCESS PER PAGE CHARGE**:  ", $labelFont, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomBorder)->addText("\${$this->leaseDetails->monochromeCPP}", null, $this->paragraphStyle->noSpacingCentered);
$leaseDetailsTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomRightBorder)->addText("\${$this->leaseDetails->colorCPP}", null, $this->paragraphStyle->noSpacingCentered);

// Row #5
$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->leftBorder, 4)->addText("PROGRAM SET-UP FEE {$this->leaseDetails->programFee}", $labelFont, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->leftRightBorder, 4)->addText("PROGRAM SET-UP FEE {$this->leaseDetails->programFee}", $labelFont, $noSpacing);

// Row #6t


$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->leftRightBorder, 4)->addText("APPLIES TO \"YOUR DEVICES\" AS DEFINED BOLOW       (**PLUS TAX)", $labelFont, $noSpacing);
$textRun = $leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->rightBorder, 4)->createTextRun($noSpacing);
$textRun->addText('INSTALLATION FEE: ', $labelFont);
$textRun->addText('$0.00 ', $this->fontStyle->bold);
$textRun->addText('DEVICES X ', $labelFont);
$textRun->addText('$0.00', $this->fontStyle->bold);
$textRun->addText('PER DEVICE = ', $labelFont);
$textRun->addText('$0.00', $this->fontStyle->bold);

// Row #7
$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->leftRightBorder, 4)->addText("", null, $noSpacing);
$leaseDetailsTable->addCell($agreementTableSpan ['span4'], $this->cellStyle->rightBorder, 4)->addText("SEE MPS PROGRAM PLUS EQUIPMENT AND SCHEDULE AND DEVICE USAGE TERMS AND CONDITIONS (**PLUS TAX)", $labelFont, $noSpacing);

// Agreement terms and coditions
$leaseDetailsTable->addRow();
$leaseDetailsTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->invertBackground, 8)->addText("AGREEMENT TERMS AND CONDITIONS", $this->fontStyle->invertBackground, $noSpacing);

$leaseDetailsTable->addRow();

$cell = $leaseDetailsTable->addCell($agreementTableSpan ['span4'], null, 4);
$textRun = $cell->createTextRun($noSpacing);
$textRun->addText('AGREEMENT ', $this->fontStyle->boldFinePrint);
$textRun->addText("{$this->leaseDetails->p1}", $this->fontStyle->finePrint);

$cell->addTextBreak();
$textRun = $cell->createTextRun($noSpacing);
$textRun->addText('PAGE CHARGES AND OVERAGES ', $this->fontStyle->boldFinePrint);
$textRun->addText("{$this->leaseDetails->p2}", $this->fontStyle->finePrint);

$cell->addTextBreak();
$textRun = $cell->createTextRun($noSpacing);
$textRun->addText('SERVICES AND SUPPLIES ', $this->fontStyle->boldFinePrint);
$textRun->addText("{$this->leaseDetails->p3}", $this->fontStyle->finePrint);

$cell->addTextBreak();
$textRun = $cell->createTextRun($noSpacing);
$textRun->addText('DEVICE USAGE PAYMENTS ', $this->fontStyle->boldFinePrint);
$textRun->addText("{$this->leaseDetails->p4}", $this->fontStyle->finePrint);

$cell = $leaseDetailsTable->addCell($agreementTableSpan ['span4'], null, 4);
$textRun = $cell->createTextRun($noSpacing);
$textRun->addText('REMOTE MONITORING ', $this->fontStyle->boldFinePrint);
$textRun->addText("{$this->leaseDetails->p4}", $this->fontStyle->finePrint);

$cell->addTextBreak();
$textRun = $cell->createTextRun($noSpacing);
$textRun->addText('TAXES ', $this->fontStyle->boldFinePrint);
$textRun->addText("{$this->leaseDetails->p5}", $this->fontStyle->finePrint);

$cell->addTextBreak();
$textRun = $cell->createTextRun($noSpacing);
$textRun->addText('DEFAULT AND REMEDIES ', $this->fontStyle->boldFinePrint);
$textRun->addText("{$this->leaseDetails->p6}", $this->fontStyle->finePrint);

$cell->addTextBreak();
$textRun = $cell->createTextRun($noSpacing);
$textRun->addText('LAW/FORUM ', $this->fontStyle->boldFinePrint);
$textRun->addText("{$this->leaseDetails->p7}", $this->fontStyle->finePrint);

$footerTable = $section->addTable($this->tableStyle->standard);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->invertBackground, 8)->addText("CUSTOMER'S AUTHORIZED SIGNATURE", $this->fontStyle->invertBackground, $noSpacing);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span8'], null, 8)->addText('Bacon ipsum dolor sit amet frankfurter laborum deserunt boudin sausage. Occaecat non nulla capicola sed short ribs tri-tip minim. Corned beef labore laborum proident dolore irure tenderloin filet mignon magna duis strip steak pork loin meatloaf aliquip nisi. Duis veniam prosciutto sausage biltong andouille velit jowl tri-tip tail kielbasa adipisicing ad nulla ut. Esse sint excepteur velit enim in est sirloin. ', $this->fontStyle->finePrint);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder)->addText('(As Stated Above)', null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span3'], $this->cellStyle->border, 3)->addText('X', null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span3'], $this->cellStyle->bottomBorder, 3)->addText('', null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomBorder)->addText('', null, $noSpacing);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span1'], null)->addText('CUSTOMER', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span3'], null, 3)->addText('SIGNATURE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span3'], null, 3)->addText('PRINT NAME & TITLE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span1'], null)->addText('DATE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);

$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->invertBackground, 8)->addText("OWNER (\"we\", \"us\", \"our\")", $this->fontStyle->invertBackground, $noSpacing);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder, 2)->addText("{$this->leaseDetails->companyName}", null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder, 2)->addText('', null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder, 2)->addText("{$this->leaseDetails->companyOwner}", null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder, 2)->addText('', null, $noSpacing);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span1'], null)->addText('OWNER', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span3'], null, 3)->addText('SIGNATURE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span3'], null, 3)->addText('PRINT NAME & TITLE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span1'], null)->addText('DATE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->bottomBorder, 8)->addText("{$this->leaseDetails->companyAddress}", $this->fontStyle->label, $noSpacing);

// New page for devices
$section->addPageBreak();
// Title of the document
$section->addText($this->translate($this->header->pageHeader), array (
        'size' => '18',
        'color' => '0000FF'
));
/*
 * Devices table
 */
$deviceTable = $section->addTable($this->tableStyle->standard);

/*
 * Title Row
 */
$deviceTable->addRow();
$deviceTable->addCell($deviceTableSpan ['span2'], null, 2)->addText($this->translate($this->header->subHeader), $this->fontStyle->subHeader, $noSpacing);
$deviceTable->addCell($deviceTableSpan ['span2'], $this->cellStyle->bottomAlign, 2)->addText($this->translate("Agreement No.:    {$this->agreement->number}"), null, $this->paragraphStyle->noSpacingRight);

$deviceTable->addRow();
$deviceTable->addCell($deviceTableSpan ['span4'], $this->cellStyle->invertBackground, 4)->addText($this->translate('DESCRIPTION OF OUR DEVICES'), $this->fontStyle->invertBackground, $this->paragraphStyle->noSpacing);

/*
 * Heading Row
 */
$deviceTable->addRow(600);
$deviceTable->addCell($deviceTableSpan ['span2'], $this->cellStyle->bottomLeftBorderBAlign, 2)->addText($this->translate('MAKE, MODEL NUMBER & INCLUDED ACCESSORIES'), $this->fontStyle->label, $this->paragraphStyle->noSpacing);
$deviceTable->addCell($deviceTableSpan ['span1'], $this->cellStyle->bottomRightBorderBAlign, 1)->addText($this->translate('SERIAL NO.'), $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$deviceTable->addCell($deviceTableSpan ['span1'], $this->cellStyle->bottomRightBorderBAlign, 1)->addText($this->translate('ADDRESS'), $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);

$deviceName = 'Xerox Phaser 8660';

/*
 * Device Rows
 */
/* @var $quoteDevice Quotegen_Model_QuoteDevice */
foreach ( $quote->getQuoteDevices() as $quoteDevice )
{
    $deviceTable->addRow(600);
    $deviceTable->addCell($deviceTableSpan ['span2'], $this->cellStyle->bottomLeftBorder, 2)->addText($quoteDevice->getName(), null, $this->paragraphStyle->noSpacing);
    $deviceTable->addCell($deviceTableSpan ['span1'], $this->cellStyle->bottomRightBorder, 1)->addText(' ', null, $this->paragraphStyle->noSpacing);
    $deviceTable->addCell($deviceTableSpan ['span1'], $this->cellStyle->bottomRightBorder, 1)->addText(' ', null, $this->paragraphStyle->noSpacing);
}
$section->addTextBreak();
$footerTable = $section->addTable('termDetailStyle');
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->invertBackground, 8)->addText("CUSTOMER'S AUTHORIZED SIGNATURE", $this->fontStyle->invertBackground, $noSpacing);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span8'], null, 8)->addText('Bacon ipsum dolor sit amet frankfurter laborum deserunt boudin sausage. Occaecat non nulla capicola sed short ribs tri-tip minim. Corned beef labore laborum proident dolore irure tenderloin filet mignon magna duis strip steak pork loin meatloaf aliquip nisi. Duis veniam prosciutto sausage biltong andouille velit jowl tri-tip tail kielbasa adipisicing ad nulla ut. Esse sint excepteur velit enim in est sirloin. ', $this->fontStyle->finePrint);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder)->addText('(As Stated Above)', null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span3'], $this->cellStyle->border, 3)->addText('X', null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span3'], $this->cellStyle->bottomBorder, 3)->addText('', null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span1'], $this->cellStyle->bottomBorder)->addText('', null, $noSpacing);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span1'], null)->addText('CUSTOMER', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span3'], null, 3)->addText('SIGNATURE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span3'], null, 3)->addText('PRINT NAME & TITLE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span1'], null)->addText('DATE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);

$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->invertBackground, 8)->addText("OWNER (\"we\", \"us\", \"our\")", $this->fontStyle->invertBackground, $noSpacing);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder, 2)->addText("{$this->leaseDetails->companyName}", null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder, 2)->addText('', null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder, 2)->addText("{$this->leaseDetails->companyOwner}", null, $noSpacing);
$footerTable->addCell($agreementTableSpan ['span2'], $this->cellStyle->bottomBorder, 2)->addText('', null, $noSpacing);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span1'], null)->addText('OWNER', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span3'], null, 3)->addText('SIGNATURE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span3'], null, 3)->addText('PRINT NAME & TITLE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addCell($agreementTableSpan ['span1'], null)->addText('DATE', $this->fontStyle->label, $this->paragraphStyle->noSpacingCentered);
$footerTable->addRow();
$footerTable->addCell($agreementTableSpan ['span8'], $this->cellStyle->bottomBorder, 8)->addText("{$this->leaseDetails->companyAddress}", $this->fontStyle->label, $noSpacing);


