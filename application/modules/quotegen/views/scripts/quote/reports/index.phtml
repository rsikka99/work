<?php
$quote = $this->Quote();
/* @var $quote Quotegen_Model_Quote */
$this->activePage = 'reports';
echo $this->render('_partials/quoteHeading.phtml');
$this->headScript()->appendFile($this->baseUrl('/js/htmlReport.js'));

$contractTemplates = Quotegen_Model_Mapper_ContractTemplate::getInstance()->fetchAllForDealer($this->Identity()->dealerId);
?>
<div class="row-fluid">
    <div class="span6">
        <h3>Download Quote</h3>

        <p>Download a .docx version of this quote.</p>
        <a class="downloadButton btn btn-primary" data-ext="docx" href="<?php echo $this->url(array('action' => (($quote->isLeased()) ? 'lease' : 'purchase') . '-quote', 'format' => 'docx')); ?>">
            <i class='icon-download-alt icon-white'></i>
            Download Quote
        </a>
    </div>
    <div class="span6">
        <h3>Download Contract</h3>

        <p>Download a contract based on a pre defined template.</p>
        <div class="input-append">
            <select id="contractTemplateId" name="contractTemplateId">
                <?php foreach ($contractTemplates as $contractTemplate) : ?>
                    <option value="<?= $contractTemplate->id ?>"><?= $contractTemplate->templateName ?></option>
                <?php endforeach; ?>
            </select>
            <a class="downloadButton btn btn-primary" data-ext="docx" data-extra-parameter="contractTemplateId" href="<?php echo $this->url(array('action' => 'contract', 'format' => 'docx')); ?>">
                <i class='icon-download-alt icon-white'></i>
                Download Contract
            </a>
        </div>
    </div>
</div>
<hr>
<div class="row-fluid">
    <div class="span6">
        <h3>Download Order List</h3>

        <p>Download a .XLSX file for the items in this quote.</p>
        <a class="downloadButton btn btn-success" data-ext="xlsx" href="<?php echo $this->url(array('action' => 'order-list', 'format' => 'xlsx')); ?>">
            <i class='icon-download-alt icon-white'></i>
            Download Order List
        </a>
    </div>
    <div class='span6'>
        <h3>Quote Settings</h3>
        <?php echo $this->form; ?>
    </div>
</div>
<hr>
<?php if ($quote->isLeased()) : ?>
    <?php echo $this->render('quote/reports/lease-quote.phtml'); ?>
<?php else : ?>
    <?php echo $this->render('quote/reports/purchase-quote.phtml'); ?>
<?php endif; ?>
<?php echo $this->navigationForm; ?>
