<?php 
$quote = $this->quote; /* @var $quote Quotegen_Model_Quote */
$this->placeholder('ProgressionNav')->set($this->render('_partials/quoteHeading.phtml'));
?>
<div class="row">
    <div class="span12">
        <div class="clearfix">
            <div class="pull-right">
                <a href="<?php echo $this->url(array('action' => 'sync-all-device-configurations')); ?>" title="Sync all configurations with current information." class="btn btn-mini btn-info "><i class="icon-refresh"></i> Sync All Devices</a>
            </div>
            <form class="form-inline" method="POST">
                <div class="control-group">
                    <div class="controls">
                    
                        <select name="deviceConfigurationId">
                            <option value="-1">New Configuration</option>
                            <option value="1">Favorite 1</option>
                            <option value="2">Favorite 2</option>
                            <option value="3">Favorite 3</option>
                        </select>
                        <button type="submit" name="submit" class="btn btn-success">Add</button>    
                    </div>
                </div>
            </form>
        </div>
        <div>
            <table class="quoteDevices">
                <thead>
                    <tr>
                        <th>QTY</th>
                        <th>Device</th>
                        <th>Device Price</th>
                        <th style="width: 100px;">Calculated Package Price</th>
                        <th>Margin</th>
                        <th style="width: 100px;">Sub Total</th>
                        <th style="width: 100px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($quote->getQuoteDevices() as $quoteDevice) : /* @var $quoteDevice Quotegen_Model_QuoteDevice */ ?>
                    <tr class="deviceRow">
                        <td><?php echo $quoteDevice->getQuantity(); ?></td>
                        <td><?php echo $quoteDevice->getName(); ?></td>
                        
                        <td><?php echo $this->currency($quoteDevice->getPrice()); ?></td>
                        <td><?php echo $this->currency($quoteDevice->calculatePackagePrice()); ?></td>
                        <td><?php echo $quoteDevice->getMargin(); ?>%</td>
                        <td><?php echo $this->currency($quoteDevice->calculateSubTotal()); ?></td>
                        <td>
                            <div class="btn-group">
                            <?php if ($quoteDevice->getDevice()) : ?>
                                <a href="<?php echo $this->url(array('action' => 'sync-device-configuration', 'id' => $quoteDevice->getId())); ?>" title="Sync Configuration with current information." class="btn btn-mini btn-info "><i class="icon-refresh"></i></a>
                            <?php else : ?>
                                <a href="javascript:;" title="Sync Configuration with current information." class="btn btn-mini btn-info disabled"><i class="icon-refresh"></i></a>
                            <?php endif; ?>
                                <a href="<?php echo $this->url(array('action' => 'edit-quote-device', 'id' => $quoteDevice->getId())); ?>" title="Edit Device" class="btn btn-mini btn-warning "><i class="icon-pencil"></i></a>
                                <a href="<?php echo $this->url(array('action' => 'delete-quote-device', 'id' => $quoteDevice->getId())); ?>" title="Remove Device" class="btn btn-mini btn-danger "><i class="icon-trash"></i></a>
                            </div>
                        </td>
                    </tr>
                    <tr class="optionRow">
                        
                        <td colspan="2">
                            <br>
                            <h4>Device Options</h4>
                            <?php if (count($quoteDevice->getQuoteDeviceOptions()) > 0) : ?>
                            <table>
                                <tr>
                                    <th style="width: 40px;">QTY</th>
                                    <th>Option Name</th>
                                    <th style="width: 100px;">QTY Included</th>
                                    <th style="width: 120px;">Price</th>
                                </tr>
                            <?php foreach ($quoteDevice->getQuoteDeviceOptions() as $quoteDeviceOption) : /* @var $quoteDeviceOption Quotegen_Model_QuoteDeviceOption */ ?>
                                <tr>
                                    <td><?php echo $quoteDeviceOption->getQuantity(); ?></td>
                                    <td><?php echo $quoteDeviceOption->getName(); ?></td>
                                    <td><?php echo $quoteDeviceOption->getIncludedQuantity(); ?></td>
                                    <td><?php echo $this->currency($quoteDeviceOption->getPrice()); ?></td>
                                </tr>
                            <?php endforeach; ?>
                            </table>
                            <?php else : ?>
                            <p>There are no options attached to this configuration.</p>
                            <?php endif; ?>
                        </td>
                        <td colspan="5">
                            <br>
                            <h4>Leasing Pages</h4>
                            <table>
                                <tr>
                                    <th>SKU</th>
                                    <th style="width: 120px;">Type</th>
                                    <th style="width: 80px;">Included</th>
                                    <th style="width: 60px;">CPP</th>
                                    <th style="width: 60px;">Price</th>
                                <tr>
                                    <td>SKUABC123</td>
                                    <td>Print - Color</td>
                                    <td>5,000</td>
                                    <td>$0.12</td>
                                    <td>$120.55</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    
                    
                    <?php endforeach; ?>
                </tbody>
            </table>
        
        
            
        </div>
    </div>
</div>
